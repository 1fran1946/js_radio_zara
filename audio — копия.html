<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" type="image/x-icon" href=
"data:image/gif;base64,R0lGODlhEAAQAOYAAP///wAAAEINN2UVVAFgnS9igVWLrAR+OQQfD0kOPYYESAB0uDFVbHKa1gCQIUgMPIQCRgB1tzBSZ3Oc2ACOG08SQoIMTgB0uiVSbnSf3QCMG2A+WpNRdEGbwkVcbpiq2gCKHHBnbKCLkLjFx3RpaNe5ywCNIZKSkXh4dubn5mNgXreYqgCULODe30lIRujn6IuJim9QYQCiPD8/PsnIyIGAf359fPb19QYAAACrRRAPD9zb23VzctnX139+f6yqqQS1UTU1NczLyoB/f7Cvr3Rzcc7NzQcICAW1UUtKSs3MzK2sq4SDgri3t4WEhN3c3BoaGRoYF0pHRoiHhsbFxJeVlYaFhb69u3p5eamoqKempiMhH0dFRGFfXpiXlpaVlouKiqWkpMjHxzw9OyIgHklFRWtpaLu6ueHg35WTkyAgIB4cGjs5OD07OhcWFgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFewAAACwAAAAAEAAQAAAHooAAgoOEAAFRW2RrhYwBUlxlbIyFAVNdZm2TgwEBVF5nbpqCAUlVX2gBopxKVmBpqZOcQUtXYWqwlAE6QkxYYpzAwQEzO0NNWWOcAgkPFRshJy00PEROWsADChAWHCIoLjU9RU/BBAsRFx0jKS82PkZQwQUMEhgeJCowNz9HwgYNEzJ8KLEiBg5hnA44oKABhAkWMnIAQUKR4gEEGDNq3IggEAA7">

<style>
:root {--fon: #a6e6b7}
body {
	margin:0; padding:0;
	font-family: sans-serif;
	font-size: 30px; 
	text-align: center; 
	background-color: var(--fon);
	color: #0A0BA3;
	}
main {background: #def;}	
	
h1 {
	font-size: 1.5em;
	border: solid 3px blue;
	border-radius: 9px;
	line-height: 3.68em;
	margin-block-start:0;
	margin-block-end:0;
	}
button {font-size: 33px;}
#post{
	text-align: left;
	b0ackground-color: #def;
	padding:20px 0 20px 14px;
	min-width:253px;
	width:24%;
	}
/*	.atb {margin: 0 auto; border: 0px;  height: 100%;}	
	.atd2 {
	
	
	height: 100%; padding: 0px; vertical-align: top;}	
*/	
.atd1 {

	b0ackground: green; 
	width: 75%;  
	padding: 5px; 
	padding-bottom:12px;
	}
	
/*v0ertical-align: top;h0eight: 100%;
    .adv {
	 width: 100%; margin: 0px; height: 100%;
	 border: red dashed 3px; 
     background: white; color: black; 
     padding-left: 0px; text-align: left;
	}*/	

	
@media screen and (max-width: 4080px) {
main {
	margin: auto; width: 90%;
	display: flex; flex-direction: row;align-items:center;
	b0ackground:navy;
	}
#t {margin:10px;}
.atd1 {border-right:4px solid var(--fon);}
}

@media screen and (max-width: 790px) {
main {
	width: 100%;
	display: flex; flex-direction: column;
	b0ackground:lime;
	font-size:20px;
	overflow: hidden;
	}
.atd1 {
	margin:auto;
	border-bottom:4px solid var(--fon);

	width: 100%;  
	padding: 1px 0 12px; }	
#t {margin:1px;width:94%;}
button {font-size:23px;}

}
	
</style>
</head>
<body>

<main>
<div class="atd1">
	<div id="js25">
		<h1>Аудио&nbsp;заря</h1>
	</div>
	<textarea id="t" cols=50 rows=10>
	Белые ночи — сплошное «быть может»…
	Светится что-то и странно тревожит —
	может быть, солнце, а может, луна.
	Может быть, с грустью, а может, с весельем,
	может, Архангельском, может, Марселем
	бродят новехонькие штурмана.
	</textarea>

	<textarea id="h" cols=50 rows=10 style="display: none"></textarea>

	<article>
	<button id="btn">play</button>
	<button id="btnp" onclick="game=true;if (a.length>0)audio[no+a[psp][cur]].pause();cur=0;cur2=0;g();btn.innerHTML='play';">stop</button>
	<button id="btnc" onclick="t.value='';">clear</button>
	</article>
</div>



<div id="post"> 
<label><input type="radio" name="b01" id="b05" checked> 	ЦХ ЧЛ+</label><br>
<label><input type="radio" name="b01" id="b03"> НХ ХЛБЛИЗЬ</label><br>
<label><input type="radio" name="b01" id="b04"> РХ ГЛИЯ</label><br>
<hr>
<!-- input type="radio" name="b00" id="b00" checked> просто <br -->
<label><input type="radio" name="b00" id="b01"> упл.</label><br>
<label><input type="radio" name="b00" id="b02"> разупл.</label><br>
<hr>
<label><input type="radio" name="b02" id="b06" checked> общ. </label><br>
<label><input type="radio" name="b02" id="b07"> совм. </label><br>
<label><input type="radio" name="b02" id="b08"> личн. </label><br>
</div>


</main>



<div  class="adv" style="display: none;">
	<div>
		<div style="d0isplay: none;background-color: #fed">
		<audio controls><source src="h/h01.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h02.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h03.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h04.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h2/h05.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h06.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h07.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h08.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h09.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h10.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h11.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h12.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h13.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h14.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h15.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h16.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h17.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h18.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h19.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h20.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h21.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h22.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h23.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h24.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h25.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h26.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h27.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h28.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h29.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h2/h30.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h31.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h32.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h/h33.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="math/plus.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="math/minus.mp3" type="audio/mpeg"></audio><br>

		<audio controls><source src="numb/n01.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n02.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n03.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n04.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n05.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n06.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n07.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n08.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n09.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n10.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n11.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n12.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n13.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n14.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n15.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n16.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n17.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n18.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n19.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n20.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n21.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="h2/joy22.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n23.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n24.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n25.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n26.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n27.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n28.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n29.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n30.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n31.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n32.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/n33.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/near.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="numb/far.mp3" type="audio/mpeg"></audio><br>

		<audio controls><source src="hard/r01.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r02.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r03.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r04.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r05.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r06.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r07.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r08.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r09.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r10.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r11.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r12.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r13.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r14.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r15.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r16.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r17.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r18.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r19.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r20.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r21.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r22.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r23.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r24.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r25.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r26.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r27.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r28.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r29.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r30.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r31.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r32.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/r33.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/gloo.mp3" type="audio/mpeg"></audio><br>
		<audio controls><source src="hard/blok.mp3" type="audio/mpeg"></audio><br>
		именные
		</div>
	</div>
</div>



<script>
let no=0; // смещения на номера
let game=true;
let audioNL = document.querySelectorAll('audio');
let audio = Array.apply(null, audioNL);
let v=t.value.replace(/[^а-яёЁ]/gi,'').toLowerCase();
h.value=v;
let alf='абвгдеёжзийклмнопрстуфхцчшщъыьэюя+-';
let cod='оаетисвлнрдукыпябзмьчжгйхёшюцщфэъ+-';
let lik='лиоеатнясдрвкыумхзпьжчфюйбгэёцщшъ+-';

let a=[
	v.split('').map(c=>alf.indexOf(c)),
	v.split('').map(c=>alf.indexOf(cod[alf.indexOf(c)])),
	v.split('').map(c=>alf.indexOf(lik[alf.indexOf(c)]))
	];

let cur2=0,cur=0,psp;
psp=+!b06.checked;//(b06.checked)?0:1;
//var 
function inccur(){
	cur++;
	if(/[^+-]/.test(v[cur])) cur2++;//cur2=cur2+1;
	}

let ko=0, myList, my=true;

function q(x){
	ko++;
	return (ko==cur2+1)?'<mark class="m">'+x+'</mark>':x;
	}

function g(){
	// подсвети букву номер cur
	ko=0;
	js25.innerHTML='';
	myList.forEach(c=>
		{
		//console.log(x);
		js25.innerHTML += c.replace(/[а-яёЁ]/gi, q);
		js25.innerHTML += '<br>';
		})
	}



audio.forEach(c=>{
		//let index = audio.indexOf(c);
		c.addEventListener('ended', ()=> {
			c.currentTime = 0;
			inccur();
			if (cur !== a[psp].length) g();
			if (cur == a[psp].length) game=true;
			btn.innerHTML=(cur !== a[psp].length)?'pause':'play';//?"▌▌":"►";
			cur !== a[psp].length ?
				audio[no+a[psp][cur]].play() :
				null
		})
	});
        
//************************************************		
btn.addEventListener('click',()=> {
	if (!game) {
		game=true;
		btn.innerHTML='play';
		if (a[psp].length)//(a[psp].length>0)
			audio[no+a[psp][cur]].pause();
		}// ато многоголосица
		else{
		game=false;// воспроизводится
		myList = t.value.split('\n');
		v=t.value.replace(/[^а-яёЁ]/gi,'').toLowerCase();
		let vv=[], vd, va='';
		myList.forEach(x=>{vv=x.split(/[^а-яёЁ]+/i);
			vv.forEach(y=>{
				if (y!=''){va+=y.split('').join('+').toLowerCase()}
				});
			});
		
		//console.log(va);
		//forEach(function(y){y.split('').join('+')}); 
		
		if(b01.checked)v=va;//v.split('').join('+');
		if(b02.checked)v=v.split('').join('-')+'-';	
		//if (b02.checked&&b03.checked)v+='-';
		//no=(b03.checked)?35:0;
		if (b05.checked) no=0;				
		if (b03.checked) no=35;
		if (b04.checked) no=70;
		//psp=(b06.checked)?0:1;
		if (b06.checked) psp=0;
		if (b07.checked) psp=1;
		if (b08.checked) psp=2;				
		if(h.value!=v) {cur=0;cur2=0;}// подредакчен ритм курсор обнулить
		


		h.value=v;
		//a=v.split('').map(function(x){return alf.indexOf(x)});
		a=[
			v.split('').map(function(x){return alf.indexOf(x)}),
			v.split('').map(function(x){return alf.indexOf(cod[alf.indexOf(x)])}),
			v.split('').map(function(x){return alf.indexOf(lik[alf.indexOf(x)])})
			];				
		if(cur>=a[psp].length) {cur=0;cur2=0;}//
		js25.innerHTML='';
		myList.forEach(c=>{
			if(!!c)js25.innerHTML+=c+'<br>'});
		g();//
		btn.innerHTML='pause';//(true)?"▌▌":"►";
		if((a.length)&&(cur<a.length))
		   audio[no+a[psp][cur]].play();
		}//else end
   })
//*************************
</script>
</body>
</html>
